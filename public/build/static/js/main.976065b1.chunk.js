(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{100:function(e,a,n){},108:function(e,a,n){},109:function(e,a,n){},110:function(e,a,n){},111:function(e,a,n){},112:function(e,a,n){"use strict";n.r(a);var t=n(0),r=n.n(t),s=n(33),c=n.n(s),l=n(26),o=n(39),i=n(11),d=n(83),u=n(120),j=n(121),b=n(119),m=n(12),p=n(2),g={lat:21,lng:22},h=r.a.createContext(),O=function(e){var a=e.children,n=Object(t.useState)(g),r=Object(m.a)(n,2),s=r[0],c=r[1];return Object(p.jsx)(h.Provider,{value:[s,c],children:a})},x=n(82),f=(n(94),n(41));var v={width:"100%",height:"100%"},N=["places"],y=["AIzaSyDPhm0risaLIrVV07dBLXLH-fWt1HK6F1c"],k=[{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#444444"}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#f2f2f2"}]},{featureType:"landscape",elementType:"geometry.fill",stylers:[{visibility:"on"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"all",stylers:[{saturation:-100},{lightness:45}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"all",stylers:[{color:"#6658a6"},{visibility:"on"}]}];function S(e){var a=Object(f.d)({googleMapsApiKey:y,libraries:N}),n=a.isLoaded,t=a.loadError,s=r.a.useState(null),c=Object(m.a)(s,2),l=c[0],o=c[1];return t?Object(p.jsx)("p",{children:'"error loading google script"'}):n?Object(p.jsx)("div",{className:"map",children:Object(p.jsxs)(f.a,{mapContainerStyle:v,center:e.center,zoom:e.zoom,options:{styles:k},children:[e&&e.hazardData.map((function(e){return Object(p.jsx)(f.c,{position:{lat:e.lat,lng:e.lng},icon:{url:"./icons/alert.png",scaledSize:new window.google.maps.Size(25,25)},onClick:function(){o(e)}},e._id)})),l?Object(p.jsx)(f.b,{position:{lat:l.lat,lng:l.lng},onCloseClick:function(){console.log(l),o(null)},children:Object(p.jsxs)("div",{children:[Object(p.jsx)("h3",{children:l.hazardType}),Object(p.jsx)("p",{className:"infoP",children:l.address}),Object(p.jsxs)("p",{className:"infoP",children:["Round Number: ",l.roundNumber]}),Object(p.jsx)("p",{className:"infoP",children:l.message})]})}):null]})}):Object(p.jsx)("p",{children:'"Loading..."'})}var w,z,C,T,I,$,P=r.a.memo(S),A=n(52),R=n(53),L=n(64),_=new(function(){function e(){Object(A.a)(this,e)}return Object(R.a)(e,[{key:"getProfile",value:function(){return Object(L.a)(this.getToken())}},{key:"loggedIn",value:function(){var e=this.getToken();return!!e&&!this.isTokenExpired(e)}},{key:"isTokenExpired",value:function(e){try{return Object(L.a)(e).exp<Date.now()/1e3}catch(a){return!1}}},{key:"getToken",value:function(){return localStorage.getItem("id_token")}},{key:"login",value:function(e){localStorage.setItem("id_token",e),window.location.assign("/")}},{key:"logout",value:function(){localStorage.removeItem("id_token"),localStorage.removeItem("state"),window.location.assign("/")}}]),e}()),F=(n(95),n(34)),H=n(122),D=(Object(H.a)(w||(w=Object(F.a)(["\n  {\n    user {\n      _id\n      firstName\n      lastName\n      email\n    }\n  }\n"]))),Object(H.a)(z||(z=Object(F.a)(["\n  query getOneRound($roundNumber: Int!) {\n    getOneRound(roundNumber: $roundNumber) {\n      _id\n      roundNumber\n      startAddress\n      lpo\n      lat\n      lng\n      hazards{\n        _id\n        roundNumber\n        hazardType\n        address\n        message\n        lat\n        lng\n        user {\n          _id\n        }\n      }\n    }\n  }\n"])))),M=Object(H.a)(C||(C=Object(F.a)(["\n  {\n    getAllHazards {\n      _id\n      hazardType\n      roundNumber\n      round {\n        startAddress\n        lpo\n      }\n      address\n      message\n      lat\n      lng\n      user {\n        _id\n      }\n    }\n  }\n"]))),B=n(123),E=function(){var e=Object(B.a)(M),a=e.loading,n=e.data,t=e.error;if(a)return Object(p.jsx)("p",{children:"Loading..."});if(t)return Object(p.jsxs)("p",{children:["error fetching hazards ",t]});console.log("data:",n);var r=n.getAllHazards;console.log("hazard data:",r);return Object(p.jsx)("div",{className:"homeContainer",children:Object(p.jsxs)("div",{className:"mapContainer",children:[Object(p.jsx)(P,{hazardData:r,center:{lat:-32.03784,lng:115.80174},zoom:13}),_.loggedIn()?Object(p.jsx)("div",{}):Object(p.jsx)("p",{id:"prompt",children:"Sign in to add hazards"})]})})},J=(n(96),n(97),function(e){console.log("props",e);var a=e.hazards;console.log("round hazard data:",a);var n=Object(B.a)(D,{variables:{roundNumber:parseInt(e.roundData.roundNumber)}}),t=n.loading,r=n.data,s=n.error;if(console.log("data:",r),t)return Object(p.jsx)("p",{children:"Loading..."});if(s)return Object(p.jsxs)("p",{children:["error fetching round data ",s]});var c=r.getOneRound;return console.log("RRRRRR",c),Object(p.jsx)("div",{className:"report",children:r&&Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("h2",{className:"reportTitle",children:["Round ",c.roundNumber]}),Object(p.jsxs)("p",{className:"genP",children:["Start Address: ",c.startAddress]}),Object(p.jsxs)("p",{className:"genP",children:["LPO: ",c.lpo]}),Object(p.jsxs)("p",{className:"genP",children:["Depot Bins: ",c.lpo]}),Object(p.jsx)("h2",{className:"reportH2",children:"Hazards"}),Object(p.jsx)("div",{className:"hazardCards",children:c.hazards.map((function(e){return Object(p.jsxs)("div",{className:"hazardCard",children:[Object(p.jsx)("p",{className:"reportP",children:e.hazardType}),Object(p.jsx)("p",{className:"reportP",children:e.address}),Object(p.jsxs)("p",{className:"reportP",children:["Message: ",e.message]})]},e._id)}))}),Object(p.jsx)("div",{className:"roundMapContainer",children:Object(p.jsx)(P,{hazardData:c.hazards,center:{lat:c.lat,lng:c.lng},zoom:13})})]})})}),U=(n(98),function(){var e=Object(t.useState)(null),a=Object(m.a)(e,2),n=a[0],r=a[1],s=Object(t.useState)(null),c=Object(m.a)(s,2),l=c[0],o=c[1];return console.log("requestedRound:",n),Object(p.jsxs)("div",{className:"reportContainer",children:[Object(p.jsx)("div",{className:"searchContainer",children:Object(p.jsxs)("form",{className:"searchForm",children:[Object(p.jsx)("label",{htmlFor:"roundNumber",className:"label",id:"searchLabel",children:"Enter a round number"}),Object(p.jsx)("input",{label:"roundNumber",onChange:function(e){o({roundNumber:e.target.value})},type:"number",className:"input",id:"searchInput",min:"1",max:"10",placeholder:"Round Number"}),Object(p.jsx)("button",{className:"button",id:"searchBtn",onClick:function(e){r(l),e.preventDefault()},children:"submit"})]})}),n&&Object(p.jsx)(J,{roundData:n})]})}),K=function(){return Object(p.jsx)("div",{className:"roundContainer",style:{backgroundImage:"url(./icons/purpleCity.PNG)",backgroundPosition:"right center",backgroundSize:"cover"},children:Object(p.jsx)(U,{})})},V=n(38),q=n(31),G=n.n(q),W=n(45),X=Object(H.a)(T||(T=Object(F.a)(["\n  mutation login($email: String!, $password: String!) {\n    login(email: $email, password: $password) {\n      token\n      user {\n        firstName\n        lastName\n        email\n        _id\n      }\n    }\n  }\n"]))),Q=Object(H.a)(I||(I=Object(F.a)(["\n  mutation addUser(\n    $firstName: String!\n    $lastName: String!\n    $email: String!\n    $password: String!\n  ) {\n    addUser(\n      firstName: $firstName\n      lastName: $lastName\n      email: $email\n      password: $password\n    ) {\n      token\n      user {\n        firstName\n        lastName\n        email\n        _id\n      }\n    }\n  }\n"]))),Y=Object(H.a)($||($=Object(F.a)(["\n  mutation addHazard(\n    $roundNumber: Int!\n    $hazardType: String!\n    $message: String\n    $address: String!\n    $lat: Float!\n    $lng: Float!\n    $user: ID!\n  ) {\n    addHazard(\n      roundNumber: $roundNumber\n      hazardType: $hazardType\n      message: $message\n      address: $address\n      lat: $lat\n      lng: $lng\n      user: $user\n    ){\n      _id\n      roundNumber\n      hazardType\n      message\n      address\n      lat\n      lng\n      user{\n        _id\n      }\n    }\n  }\n\n\n"]))),Z=n(125),ee=(n(100),n(59)),ae=n(49);n(101);var ne=function(){var e=Object(ee.a)({requestOptions:{location:{lat:function(){return-32.03784},lng:function(){return 115.80174}},radius:5e3}}),a=e.ready,n=e.value,r=e.suggestions,s=r.status,c=r.data,l=e.setValue,o=e.clearSuggestions,i=Object(t.useContext)(h),d=Object(m.a)(i,2),u=(d[0],d[1]);return Object(p.jsxs)(ae.a,{onSelect:function(){var e=Object(W.a)(G.a.mark((function e(a){var n,t,r,s,c;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(a,!1),o(),e.prev=2,e.next=5,Object(ee.b)({address:a});case 5:return n=e.sent,console.log(n),t=n[0].formatted_address,e.next=10,Object(ee.c)(n[0]);case 10:r=e.sent,s=r.lat,c=r.lng,console.log(s,c),u({lat:s,lng:c,address:t}),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(2),console.log("autocomplete error",e.t0);case 21:case"end":return e.stop()}}),e,null,[[2,18]])})));return function(a){return e.apply(this,arguments)}}(),children:[Object(p.jsx)(ae.b,{className:"searchBox",value:n,onChange:function(e){l(e.target.value)},disabled:!a,placeholder:"Enter an address"}),Object(p.jsx)(ae.d,{children:"OK"===s&&c.map((function(e){var a=e.place_id,n=e.description;return Object(p.jsx)(ae.c,{value:n},a)}))})]})},te={roundNumber:"",hazardType:"",location:"",message:""},re=["places"],se=["AIzaSyDPhm0risaLIrVV07dBLXLH-fWt1HK6F1c"];var ce=function(e){var a=Object(t.useContext)(h),n=Object(m.a)(a,2),r=n[0],s=(n[1],Object(f.d)({googleMapsApiKey:se,libraries:re})),c=s.isLoaded,o=s.loadError;console.log("coords data:",r);var i=Object(t.useState)(te),d=Object(m.a)(i,2),u=d[0],j=d[1],b=Object(Z.a)(Y),g=Object(m.a)(b,1)[0],O=function(){var e=Object(W.a)(G.a.mark((function e(a){var n,t,s,c;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),console.log("hazard form data:",u),n=localStorage.getItem("deets"),t=JSON.parse(n),console.log("createHazard userdeets",t),e.prev=5,e.next=8,g({variables:{roundNumber:parseInt(u.roundNumber),hazardType:u.hazardType,address:r.address,lat:r.lat,lng:r.lng,message:u.message,user:t._id}});case 8:s=e.sent,c=s.data,window.location.assign("/"),console.log(c),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(5),window.location.assign("/"),console.error(e.t0);case 18:case"end":return e.stop()}}),e,null,[[5,14]])})));return function(a){return e.apply(this,arguments)}}(),x=function(e){j(Object(l.a)(Object(l.a)({},u),{},Object(V.a)({},e.target.name,e.target.value)))};return o?Object(p.jsx)("p",{children:'"error loading google script"'}):c?Object(p.jsx)("div",{className:"createHazardContainer",style:{backgroundImage:"url(./icons/blue.PNG)",backgroundPosition:"right center",backgroundSize:"cover"},children:Object(p.jsx)("div",{className:"formContainer",children:Object(p.jsxs)("form",{className:"form",onSubmit:O,children:[Object(p.jsx)("p",{className:"label",children:"Enter Address of Hazard"}),Object(p.jsx)(ne,{}),Object(p.jsx)("label",{className:"label",htmlFor:"rndNum",children:"Round Number"}),Object(p.jsx)("input",{name:"roundNumber",onChange:x,className:"input",type:"number",id:"rndNum",min:"1",max:"10",placeholder:"Please enter the Round Number "}),Object(p.jsx)("label",{className:"label",htmlFor:"hazardType",children:"Hazard Type"}),Object(p.jsxs)("select",{className:"select",name:"hazardType",id:"hazardType",onChange:x,children:[Object(p.jsx)("option",{value:"",children:"--Please choose a hazard type--"}),Object(p.jsx)("option",{value:"Aggresive Dog",children:"Aggresive Dog"}),Object(p.jsx)("option",{value:"Aggresive Magpie",children:"Aggresive Magpie"}),Object(p.jsx)("option",{value:"Blind Driveway",children:"Blind Driveway"}),Object(p.jsx)("option",{value:"Slippery Surface",children:"Slippery Surface"}),Object(p.jsx)("option",{value:"School",children:"School"}),Object(p.jsx)("option",{value:"Intersection",children:"Intersection"}),Object(p.jsx)("option",{value:"Roadworks",children:"Roadworks"}),Object(p.jsx)("option",{value:"Missing Letterbox",children:"Missing Letterbox"}),Object(p.jsx)("option",{value:"Aggresive Human",children:"Aggresive Human"}),Object(p.jsx)("option",{value:"Other",children:"Other"})]}),Object(p.jsx)("label",{className:"label",htmlFor:"message",children:"Message"}),Object(p.jsx)("textarea",{name:"message",onChange:x,className:"textArea",type:"text",id:"message",cols:"20",rows:"5",placeholder:"Add Notes"}),Object(p.jsx)("button",{className:"button",type:"submit",children:"Submit"})]})})}):Object(p.jsx)("p",{children:'"Loading..."'})},le=n(68),oe=n(71),ie=(n(63),function(e){return Object(p.jsxs)("nav",{className:"navLinks",children:[Object(p.jsx)(o.b,{exact:!0,to:"/",className:"links",activeClassName:"selected",onClick:function(){return e.isMobile&&e.closeNav()},children:"Home"}),_.loggedIn()?Object(p.jsx)(o.b,{exact:!0,to:"/create-hazard",activeClassName:"selected",className:"links",onClick:function(){return e.isMobile&&e.closeNav()},children:"Add Hazard"}):null,Object(p.jsx)(o.b,{exact:!0,to:"/round-report",activeClassName:"selected",className:"links",onClick:function(){return e.isMobile&&e.closeNav()},children:"Round Report"}),_.loggedIn()?Object(p.jsx)("button",{className:"links",id:"signBtn",onClick:function(){_.logout()},children:"Sign Out"}):Object(p.jsx)(o.b,{exact:!0,to:"/signIn",activeClassName:"selected",className:"links",onClick:function(){return e.isMobile&&e.closeNav()},children:"Sign In"})]})}),de=function(){var e=Object(t.useState)(!1),a=Object(m.a)(e,2),n=a[0],r=a[1],s=Object(p.jsx)(le.a,{className:"icon",icon:oe.a,onClick:function(){return r(!n)}}),c=Object(p.jsx)(le.a,{className:"icon",icon:oe.b,onClick:function(){return r(!1)}});return Object(p.jsxs)("div",{className:"mobNav",children:[n?c:s,n&&Object(p.jsx)(ie,{isMobile:!0,closeNav:function(){return r(!1)}})]})},ue=function(){return Object(p.jsx)("nav",{className:"deskNav",children:Object(p.jsx)(ie,{isMobile:!1})})},je=(n(108),function(){return Object(p.jsxs)("div",{className:"header",children:[Object(p.jsx)("p",{className:"logo",children:"RR"}),Object(p.jsxs)("div",{className:"navContainer",children:[Object(p.jsx)(ue,{}),Object(p.jsx)(de,{})]})]})}),be=(n(109),function(){return Object(p.jsx)("div",{className:"footer",children:Object(p.jsx)("p",{className:"footerP",children:"Created by BT"})})}),me=(n(77),function(e){var a=e.type,n=e.label,t=e.placeholder,r=e.handleChange,s=e.autoFocus;return Object(p.jsxs)("div",{className:"loginWrapper",children:[Object(p.jsx)("label",{htmlFor:n,className:"loginLabel",children:t}),Object(p.jsx)("input",{className:"loginInput",placeholder:t,name:n,type:a,id:n,onChange:r,autoFocus:s,autoComplete:a})]})}),pe={firstName:"",lastName:"",email:"",password:"",confirmPassword:""},ge={email:"",password:""};var he=function(e){var a=Object(t.useState)(pe),n=Object(m.a)(a,2),r=n[0],s=n[1],c=Object(t.useState)(ge),o=Object(m.a)(c,2),i=o[0],d=o[1],u=Object(Z.a)(X),j=Object(m.a)(u,2),b=j[0],g=j[1].error,h=Object(Z.a)(Q),O=Object(m.a)(h,1)[0],x=Object(t.useState)(!1),f=Object(m.a)(x,2),v=f[0],N=f[1],y=function(){var e=Object(W.a)(G.a.mark((function e(a){var n,t,s,c,l,o,d;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),console.log(r,i),!v){e.next=18;break}return e.prev=3,e.next=6,O({variables:{email:r.email,password:r.password,firstName:r.firstName,lastName:r.lastName}});case 6:n=e.sent,t=n.data.addUser.user,localStorage.setItem("deets",JSON.stringify(t)),s=n.data.addUser.token,_.login(s),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),console.log("error signing up:",e.t0);case 16:e.next=34;break;case 18:return e.prev=18,e.next=21,b({variables:{email:i.email,password:i.password}});case 21:c=e.sent,console.log("MutationResponse:",c.data.login.user._id),l=c.data.login.token,_.login(l),o=c.data.login.user,localStorage.setItem("deets",JSON.stringify(o)),d=localStorage.getItem("deets"),console.log("local storage deets:",JSON.parse(d)),e.next=34;break;case 31:e.prev=31,e.t1=e.catch(18),console.log("Login Failed:",e.t1);case 34:case"end":return e.stop()}}),e,null,[[3,13],[18,31]])})));return function(a){return e.apply(this,arguments)}}(),k=function(e){s(Object(l.a)(Object(l.a)({},r),{},Object(V.a)({},e.target.name,e.target.value)))},S=function(e){d(Object(l.a)(Object(l.a)({},i),{},Object(V.a)({},e.target.name,e.target.value)))};return Object(p.jsxs)("div",{className:"loginContainer",style:{backgroundImage:"url(./icons/purpleCity.PNG)",backgroundPosition:"right center",backgroundSize:"cover"},children:[Object(p.jsx)("h1",{className:"loginTitle",children:v?"Sign Up":"Sign In"}),Object(p.jsxs)("form",{onSubmit:y,className:"loginForm",children:[v&&Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(me,{placeholder:"First Name",handleChange:v?k:S,autoFocus:!0,label:"firstName",type:"firstName"}),Object(p.jsx)(me,{placeholder:"Last Name",handleChange:v?k:S,label:"lastName",type:"lastName"})]}),Object(p.jsx)(me,{placeholder:"Email Address",handleChange:v?k:S,label:"email",type:"email"}),Object(p.jsx)(me,{placeholder:"Password",handleChange:v?k:S,label:"password",type:"password",autocomplete:"password"}),g?Object(p.jsx)("div",{children:Object(p.jsx)("p",{className:"error-text",children:"The provided credentials are incorrect"})}):null,v&&Object(p.jsx)(me,{placeholder:"Repeat Password",handleChange:v?k:S,label:"password",type:"password",autocomplete:"new-password"}),Object(p.jsx)("button",{type:"submit",className:"button",children:v?"Sign Up":"Sign In"}),Object(p.jsx)("button",{onClick:function(){N((function(e){return!e}))},type:"button",className:"button",children:v?"Already have an account? Sign In":"Create Account"})]})]})},Oe=(n(110),function(){return Object(p.jsx)(t.Fragment,{children:Object(p.jsx)(he,{})})}),xe=Object(d.a)({uri:"/graphql"}),fe=Object(x.a)((function(e,a){var n=a.headers,t=localStorage.getItem("id_token");return{headers:Object(l.a)(Object(l.a)({},n),{},{authorization:t?"Bearer ".concat(t):""})}})),ve=new u.a({link:fe.concat(xe),cache:new j.a});var Ne=function(){return Object(p.jsx)(b.a,{client:ve,children:Object(p.jsx)(o.a,{children:Object(p.jsx)("div",{className:"App",children:Object(p.jsxs)(O,{children:[Object(p.jsx)(je,{}),Object(p.jsx)("div",{className:"content",children:Object(p.jsxs)(i.c,{children:[Object(p.jsx)(i.a,{exact:!0,path:"/",component:E}),Object(p.jsx)(i.a,{exact:!0,path:"/round-report",component:K}),Object(p.jsx)(i.a,{exact:!0,path:"/create-hazard",component:ce}),Object(p.jsx)(i.a,{exact:!0,path:"/signIn",component:Oe})]})}),Object(p.jsx)(be,{})]})})})})};n(111);c.a.render(Object(p.jsx)(r.a.StrictMode,{children:Object(p.jsx)(Ne,{})}),document.getElementById("root"))},63:function(e,a,n){},77:function(e,a,n){},94:function(e,a,n){},95:function(e,a,n){},96:function(e,a,n){},97:function(e,a,n){},98:function(e,a,n){}},[[112,1,2]]]);
//# sourceMappingURL=main.976065b1.chunk.js.map